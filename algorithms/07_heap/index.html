<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heap Data Structure</title>
    <link rel="stylesheet" href="https://tormozz48.github.io/blog/assets/css/style.css">
    <link rel="stylesheet" href="https://tormozz48.github.io/blog/assets/css/prism-theme.css">
</head>
<body>
    <header>
        <nav>
            <ul style="display: flex; flex-direction: row; list-style: none; padding: 0; margin: 0;">
                <li style="margin-right: 20px;"><a href="https://tormozz48.github.io/blog/">Home</a></li>
                <li style="margin-right: 20px;"><a href="https://tormozz48.github.io/blog/cv/">CV</a></li>
                <li style="margin-right: 20px;"><a href="https://tormozz48.github.io/blog/blog/">Blog</a></li>
                <li><a href="https://tormozz48.github.io/blog/algorithms/">Algorithms</a></li>
            </ul>
        </nav>
    </header>
    
    <main>
        
<article class="algorithm-page">
    <header class="algorithm-header">
        <h1>Heap Data Structure</h1>
        <p class="algorithm-description">A specialized tree-based data structure that satisfies the heap property</p>
    </header>

    <div class="algorithm-content">
        <h1>Heap Data Structure</h1>
<h2>Description</h2>
<p>A heap is a specialized tree-based data structure that satisfies the heap property. In a min-heap, for any given node, the value of the node is less than or equal to the values of its children. In a max-heap, the value of the node is greater than or equal to the values of its children. Heaps are commonly implemented as binary trees and are used to efficiently find the minimum or maximum element.</p>
<h2>Use Cases</h2>
<ul>
<li>Finding the k largest/smallest elements</li>
<li>Implementing priority queues</li>
<li>Heap sort algorithm</li>
<li>Dijkstra's shortest path algorithm</li>
<li>Median maintenance</li>
<li>Merge k sorted lists</li>
</ul>
<h2>Code Example</h2>
<pre class="language-typescript"><code class="language-typescript"><span class="token comment">/**
 * Implementation of a Min Heap
 */</span>
<span class="token keyword">class</span> <span class="token class-name">MinHeap</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> heap<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>heap <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * Get the size of the heap
     */</span>
    <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * Get the minimum element without removing it
     */</span>
    <span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * Insert a new element into the heap
     * @param val Value to insert
     */</span>
    <span class="token function">insert</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token comment">// Add the element to the end of the heap</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// Bubble up to maintain the heap property</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">bubbleUp</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * Remove and return the minimum element
     */</span>
    <span class="token function">extractMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">const</span> min <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> last <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Move the last element to the root and sink down</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> last<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sinkDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">return</span> min<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * Bubble up the element at the given index to maintain the heap property
     * @param index Index of the element to bubble up
     */</span>
    <span class="token keyword">private</span> <span class="token function">bubbleUp</span><span class="token punctuation">(</span>index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        
        <span class="token comment">// Keep bubbling up while the parent is greater than the current element</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> parentIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>parentIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
            
            <span class="token comment">// If the parent is less than or equal to the element, we're done</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">&lt;=</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            
            <span class="token comment">// Swap with the parent</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>parentIndex<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            
            <span class="token comment">// Move up to the parent index</span>
            index <span class="token operator">=</span> parentIndex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * Sink down the element at the given index to maintain the heap property
     * @param index Index of the element to sink down
     */</span>
    <span class="token keyword">private</span> <span class="token function">sinkDown</span><span class="token punctuation">(</span>index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> length <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> leftChildIndex <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> rightChildIndex <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> index <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> leftChild<span class="token punctuation">,</span> rightChild<span class="token punctuation">;</span>
            <span class="token keyword">let</span> swapIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            
            <span class="token comment">// Check if the left child exists and is less than the current element</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>leftChildIndex <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                leftChild <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>leftChildIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>leftChild <span class="token operator">&lt;</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    swapIndex <span class="token operator">=</span> leftChildIndex<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            
            <span class="token comment">// Check if the right child exists and is less than the current element</span>
            <span class="token comment">// and the left child</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rightChildIndex <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rightChild <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>rightChildIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>
                    <span class="token punctuation">(</span>swapIndex <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rightChild <span class="token operator">&lt;</span> element<span class="token punctuation">)</span> <span class="token operator">||</span>
                    <span class="token punctuation">(</span>swapIndex <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rightChild <span class="token operator">&lt;</span> leftChild<span class="token operator">!</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    swapIndex <span class="token operator">=</span> rightChildIndex<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            
            <span class="token comment">// If no swap is needed, we're done</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>swapIndex <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            
            <span class="token comment">// Swap with the smaller child</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>swapIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">[</span>swapIndex<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>
            
            <span class="token comment">// Move down to the swapped index</span>
            index <span class="token operator">=</span> swapIndex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Problem: Find the k largest elements in an array
 * 
 * @param nums Array of numbers
 * @param k Number of largest elements to find
 * @returns Array of k largest elements
 */</span>
<span class="token keyword">function</span> <span class="token function">findKLargest</span><span class="token punctuation">(</span>nums<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token comment">// Use a min heap to keep track of the k largest elements</span>
    <span class="token keyword">const</span> minHeap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MinHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> num <span class="token keyword">of</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// If the heap has less than k elements, add the current element</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minHeap<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            minHeap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        <span class="token comment">// If the current element is larger than the smallest element in the heap,</span>
        <span class="token comment">// remove the smallest and add the current element</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">></span> minHeap<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            minHeap<span class="token punctuation">.</span><span class="token function">extractMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            minHeap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Extract all elements from the heap to get the k largest elements</span>
    <span class="token keyword">const</span> result<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>minHeap<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>minHeap<span class="token punctuation">.</span><span class="token function">extractMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Example usage</span>
<span class="token keyword">const</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> k <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>k<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> largest elements:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token function">findKLargest</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: The 3 largest elements: [5, 6, 9] (not necessarily in sorted order)</span></code></pre>
<h2>LeetCode Example Problems</h2>
<ul>
<li><a href="https://leetcode.com/problems/kth-largest-element-in-an-array/">LeetCode 215. Kth Largest Element in an Array</a></li>
<li><a href="https://leetcode.com/problems/top-k-frequent-elements/">LeetCode 347. Top K Frequent Elements</a></li>
<li><a href="https://leetcode.com/problems/merge-k-sorted-lists/">LeetCode 23. Merge k Sorted Lists</a></li>
<li><a href="https://leetcode.com/problems/find-median-from-data-stream/">LeetCode 295. Find Median from Data Stream</a></li>
</ul>
<h2>Complexity Analysis</h2>
<p>For a binary heap:</p>
<ul>
<li>
<p><strong>Time Complexity</strong>:</p>
<ul>
<li>Insertion: O(log n)</li>
<li>Extraction (min/max): O(log n)</li>
<li>Peek (min/max): O(1)</li>
<li>Building a heap from an array: O(n)</li>
</ul>
</li>
<li>
<p><strong>Space Complexity</strong>: O(n) where n is the number of elements in the heap.</p>
</li>
</ul>
<p>For the findKLargest example:</p>
<ul>
<li><strong>Time Complexity</strong>: O(n log k) where n is the length of the input array and k is the number of largest elements to find.</li>
<li><strong>Space Complexity</strong>: O(k) for storing the k largest elements in the heap.</li>
</ul>
<h2>When to Use</h2>
<p>Use a heap when:</p>
<ul>
<li>You need to efficiently find and remove the minimum or maximum element</li>
<li>You need to implement a priority queue</li>
<li>You need to find the k largest/smallest elements</li>
<li>You're working with algorithms that require efficient access to the minimum/maximum element, such as Dijkstra's algorithm</li>
<li>You need to sort elements in O(n log n) time using heap sort</li>
</ul>

    </div>

    <div class="algorithm-navigation">
        <div class="algorithm-nav-links">
            
                
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                

                
                

                <div class="algorithm-nav-previous">
                    
                        <a href="/algorithms/06_binary_tree_bfs/" class="algorithm-nav-link">
                            <span class="algorithm-nav-direction">Previous</span>
                            <span class="algorithm-nav-title">Binary Tree BFS (Breadth-First Search)</span>
                        </a>
                    
                </div>

                <div class="algorithm-nav-index">
                    <a href="/algorithms/" class="algorithm-index-link">All Algorithms</a>
                </div>

                <div class="algorithm-nav-next">
                    
                        <a href="/algorithms/08_priority_queue/" class="algorithm-nav-link">
                            <span class="algorithm-nav-direction">Next</span>
                            <span class="algorithm-nav-title">Priority Queue</span>
                        </a>
                    
                </div>
            
        </div>
    </div>
</article>

    </main>
    
    <footer>
        <p>&copy; 2025 Andrii Kuznietsov. All rights reserved.</p>
    </footer>
    <script src="https://tormozz48.github.io/blog/assets/js/animation.js"></script>
</body>
</html>
